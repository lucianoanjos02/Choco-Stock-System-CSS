{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf%}

{% block styles %}

{{ super() }}

<link rel="stylesheet"href="{{url_for('static', filename='css/pesquisa_estoque.css')}}">
{% endblock %}

{% block title %}
    Pesquisa Estoque - CSS
{% endblock %}

{% block content %}
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false"
            aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{{ url_for('form_gerenciamento_estoque') }}">CSS</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="{{ url_for('form_gerenciamento_estoque') }}">Página Principal</a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                        Estoque
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="navbar-brand" href="{{ url_for('form_cadastro_estoque') }}">Cadastro de Estoque</a>
                            <a class="navbar-brand" href="{{ url_for('form_gerenciamento_estoque') }}">Gerenciamento de Estoque</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                        Produto
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="navbar-brand" href="{{ url_for('form_cadastro_produto') }}">Cadastro de Produto</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                        Kit
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="navbar-brand" href="{{ url_for('form_cadastro_kit') }}">Cadastro de Kit</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                        Loja
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="navbar-brand" href="{{ url_for('form_cadastro_loja') }}">Cadastro de Loja</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                        Usuário
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="navbar-brand" href="{{ url_for('cadastro_usuario') }}">Cadastro de Usuário</a>
                            <a class="navbar-brand" href="{{ url_for('form_gerenciamento_usuario') }}">Gerenciamento de Usuário</a>
                        </li>
                    </ul>
                </li>
            </ul>
            <form class="navbar-form navbar-right" action="{{ url_for('logout') }}" method="POST">
                <button type="submit" class="btn btn-success">Sair</button>
            </form>
            <div class="dropdown notification-dropdown">
                <a class="dropdown-toggle navbar-brand navbar-right notification-button" data-toggle="dropdown" href="{{ url_for('form_gerenciamento_estoque') }}" role="button" aria-haspopup="true" aria-expanded="false">
                    <i class="glyphicon glyphicon-bell"></i><span class="counter counter-lg">{{ quantidade_notificacoes_usuario }}</span>&nbsp;&nbsp;     
                </a>
                <ul class="dropdown-menu notifications" role="menu">
                    <div class="notification-heading">
                        <h4 class="menu-title">Notificações</h4>
                        <h4 class="menu-title pull-right">
                            <a class="menu-title" href="{{ url_for('visualizar_notificacoes') }}">Ver tudo</a> 
                        <i class="glyphicon glyphicon-circle-arrow-right"></i></h4></div>
                    {% for notificacao in notificacoes %}
                        <li class="divider"></li>
                        <div class="notification-wrapper">
                            <a class="content" href="#">
                                <div class="notification-item">
                                    <h4 class="item-title">{{ notificacao.assunto_notificacao }}</h4>
                                    <p class="item-info">{{ notificacao.info_notificacao }}</p>
                                    <p class="item-info">Data/Horário: {{ notificacao.data_notificacao }}</p>
                                </div>
                            </a>
                        </div>
                        <li class="divider"></li>
                    {% endfor %}
                    </div>
                </ul>
                <a class="navbar-brand navbar-right" href="#">Olá, {{ current_user.nome }}</a>
            </div>
        </div>
    </div>
</nav>
<div class="container mensagem">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-warning" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="false">&times;</span>
                </button>
            </div>
        {% endfor %}
    {% endif %}
    {% endwith %}
</div>
    <div class="container">
        <h1>Gerenciamento de Estoque</h1>
        <div class="container">
            <form name="formEstoque" class="form-horizontal" action="{{ url_for('pesquisa_estoque') }}" method="POST">
                <label class="control-label" for="filtro_pesquisa">Filtro da Pesquisa</label> 
                <select class="form-control" id="filtro_pesquisa" name="filtro_pesquisa">
                    <option value="Código Lote">Código Lote</option>
                    <option value="Produto">Produto</option>
                    <option value="Loja">Loja</option>
                </select>
                <label class="control-label" for="campo_pesquisa"></label>
                <input class="form-control" id="campo_pesquisa" name="campo_pesquisa" required type="text" placeholder="Pesquise um lote por Código do Lote, Produto ou Loja">
                <div class="col-xs-4">
                    <button class="btn btn-lg btn-primary btn-block" id="cadastrar-produto" type="submit">Pesquisar</button>
                </div>
        </div>
        </form>
        {% set count = namespace(value=0) %}
        {% for lote in estoque.values() %}
            <form name="formEstoque" class="form-horizontal" action="{{ url_for('editar_lote_estoque') }}" method="POST">
                <div class="container lote" id="produtos">
                    <div class="container info-produto" id="info-produto">
                        <div class="col-md-6">
                            <div class="form-group required">
                                <label class="control-label" for="loja">Loja</label> 
                                <input class="form-control" id="loja" name="loja" required type="text" value="{{ lote['loja'] }}" readonly=“true”>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group required">
                                <label class="control-label" for="codigo_lote">Código do Lote</label>
                                <input class="form-control" id="codigo_lote" name="codigo_lote" required type="text" value="{{ lote['codigo_lote'] }}" readonly=“true”> 
                            </div>
                        </div>
                    </div>
                        {% for produto in lote['produtos'].values() %}
                            {% set count.value = count.value + 1 %}
                            <div class="container produtos">
                                <div class="col-md-6">
                                    <div class="form-group required">
                                        <label class="control-label" for="tipo{{ count.value }}">Tipo</label>
                                        <input class="form-control" id="tipo{{ count.value }}" name="tipo{{ count.value }}" required type="text" value="{{ produto['tipo'] }}" readonly=“true”>   
                                    </div>  
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group required">
                                        <label class="control-label" for="produto{{ count.value }}">Nome do Produto</label> 
                                        <input class="form-control" id="produto{{ count.value }}" name="produto{{ count.value }}" required type="text" value="{{ produto['produto'] }}" readonly=“true”>   
                                    </div>    
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group required">
                                        <label class="control-label" for="quantidade{{ count.value }}">Quantidade</label>
                                        <input class="form-control" id="quantidade{{ count.value }}" name="quantidade{{ count.value }}" required type="number" value="{{ produto['quantidade'] }}" readonly=“true”>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group required">
                                        <label class="control-label" for="data_validade{{ count.value }}">Data de Validade</label>
                                        <input class="form-control" id="data_validade{{ count.value }}" name="data_validade{{ count.value }}" required type="date" value="{{ produto['data_validade'] }}" readonly=“true”>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                            <div class="col-md-offset-10">
                                <button class="btn btn-lg btn-danger btn-block" id="remover-produto" type="submit">
                                    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                    Remover Produto
                                </button>
                            </div>  
                </div>
            </form>
        {% endfor %}
    </div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/notificacoes.js') }}"></script>
{{ super() }}
{% endblock %}
